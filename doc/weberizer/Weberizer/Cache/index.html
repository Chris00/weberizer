<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Cache (weberizer.Weberizer.Cache)</title><link rel="stylesheet" href="../../../odoc.css"/><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> – <a href="../../index.html">weberizer</a> &#x00BB; <a href="../index.html">Weberizer</a> &#x00BB; Cache</nav><h1>Module <code>Weberizer.Cache</code></h1><p>Simple cache with dependencies and timeout.</p></header><dl><dt class="spec type" id="type-t"><a href="#type-t" class="anchor"></a><code><span class="keyword">type </span>'a t</code></dt><dd><p>A cache for elements of type 'a.</p></dd></dl><dl><dt class="spec value" id="val-make"><a href="#val-make" class="anchor"></a><code><span class="keyword">val </span>make : ?&#8288;dep:<span class="type-var">'b</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> ?&#8288;new_if:(<span class="type-var">'a</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> bool) <span>&#45;&gt;</span> ?&#8288;timeout:float <span>&#45;&gt;</span> ?&#8288;debug:bool <span>&#45;&gt;</span> string <span>&#45;&gt;</span> (<span class="type-var">'a</span> option <span>&#45;&gt;</span> <span class="type-var">'a</span>) <span>&#45;&gt;</span> <span class="type-var">'a</span> <a href="index.html#type-t">t</a></code></dt><dd><p><code>make key f</code> create a new cache to hold the return value of <code>f</code> using the <code>key</code>. <code>f</code> is given its previously returned value if any — it may be less work to update it than recreating it afresh. The disk cache will be updated when the program exits, so its content will persist across multiplie runs of the program. The type <code>'a</code> must be marshal-able.</p><dl><dt>parameter timeout</dt><dd><p>the number of seconds after which the cached value must be refreshed (running <code>f</code> again). Default: <code>3600.</code>. A non-positive value means no timeout.</p></dd></dl><dl><dt>parameter debug</dt><dd><p>print messages on <code>stderr</code> about cache usage and refresh. The string argument is a prefix to these messages to be able to distinguish different caches. Default: <code>&quot;&quot;</code> i.e., no messages.</p></dd></dl></dd></dl><dl><dt class="spec value" id="val-update"><a href="#val-update" class="anchor"></a><code><span class="keyword">val </span>update : ?&#8288;f:(<span class="type-var">'a</span> option <span>&#45;&gt;</span> <span class="type-var">'a</span>) <span>&#45;&gt;</span> <span class="type-var">'a</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> unit</code></dt><dd><p><code>update t</code> update the cache immediately. If <code>f</code> is given, first set the function generating values for the cache <code>t</code> to <code>f</code> and then update the cache by running <code>f</code>.</p></dd></dl><dl><dt class="spec value" id="val-depend"><a href="#val-depend" class="anchor"></a><code><span class="keyword">val </span>depend : <span class="type-var">'a</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> dep:<span class="type-var">'b</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> unit</code></dt><dd><p><code>depend t t'</code> says that the cache <code>t</code> depends on the cache <code>t'</code> i.e. that before updating <code>t</code>, one must update <code>t'</code>.</p></dd></dl><dl><dt class="spec value" id="val-get"><a href="#val-get" class="anchor"></a><code><span class="keyword">val </span>get : ?&#8288;update:bool <span>&#45;&gt;</span> <span class="type-var">'a</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <span class="type-var">'a</span></code></dt><dd><p>Get the value stored in the cache. This operation will update the cached value if necessary.</p><dl><dt>parameter update</dt><dd><p>if <code>true</code>, force an update. Default: <code>false</code>.</p></dd></dl></dd></dl><dl><dt class="spec value" id="val-result"><a href="#val-result" class="anchor"></a><code><span class="keyword">val </span>result : ?&#8288;dep:<span class="type-var">'b</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> ?&#8288;new_if:(<span class="type-var">'a</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> bool) <span>&#45;&gt;</span> ?&#8288;timeout:float <span>&#45;&gt;</span> ?&#8288;debug:bool <span>&#45;&gt;</span> string <span>&#45;&gt;</span> (<span class="type-var">'a</span> option <span>&#45;&gt;</span> <span class="type-var">'a</span>) <span>&#45;&gt;</span> <span class="type-var">'a</span></code></dt><dd><p><code>result key f</code> is a convenience function equivalent to <code>get(make key f)</code>.</p></dd></dl><dl><dt class="spec value" id="val-time"><a href="#val-time" class="anchor"></a><code><span class="keyword">val </span>time : <span class="type-var">'a</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> float</code></dt><dd><p>The time of the last update of the cache. Returns <code>neg_infinity</code> if the cache is not initialized.</p></dd></dl><dl><dt class="spec value" id="val-key"><a href="#val-key" class="anchor"></a><code><span class="keyword">val </span>key : <span class="type-var">'a</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> string</code></dt><dd><p><code>key t</code> returns the key used to store the value.</p></dd></dl></div></body></html>