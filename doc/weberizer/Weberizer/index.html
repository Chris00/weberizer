<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Weberizer (weberizer.Weberizer)</title><link rel="stylesheet" href="../../odoc.css"/><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> â€“ <a href="../index.html">weberizer</a> &#x00BB; Weberizer</nav><h1>Module <code>Weberizer</code></h1><p>Simple templating library. It reads HTML files &quot;with variables&quot; and can either output an OCaml module (reusable template with some static checks) or perform substitutions and return the HTML.</p><p>To parametrize the HTML, you can add the following arguments to any HTML tag:</p><pre>    ml:content=&quot;&lt;ident&gt;&quot;
    ml:content=&quot;&lt;ident&gt; &lt;arg1&gt; ... &lt;argN&gt;&quot;
    ml:strip=&quot;true&quot;   ml:strip=&quot;if empty&quot;
    ml:replace=&quot;&lt;ident&gt;&quot;					    </pre><ul><li>The argument <code>ml:content=&quot;v&quot;</code> (<code>v</code> is any valid OCaml variable name) tells that the content of the HTML tag must be replaced by the HTML contained in the OCaml variable <code>v</code>.</li><li><code>ml:content=&quot;f v1 ... vN&quot;</code> does the same but uses the return value of the OCaml function <code>f</code> on the list <code>[v1; ...; vN]</code> as the replacement HTML.</li><li><code>ml:strip=&quot;true&quot;</code> says that the HTML tag should be removed and replaced by the content.</li><li><code>ml:strip=&quot;if empty&quot;</code> says that the HTML tag should be removed only if the replacement content is empty.</li><li><code>ml:replace=&quot;v&quot;</code> is the same as <code>ml:content=&quot;v&quot;</code> except that it adds <code>ml:strip=&quot;true&quot;</code>.</li></ul><p>A special value of &lt;ident&gt; is &quot;include&quot;. It serves to include the files passed as arguments and does not define a new function.</p><p>Inside HTML arguments themselves, one can use</p><ul><li><code>${&lt;ident&gt;}</code> which is replaced by the content (a string) of the variable &lt;indent&gt;;</li><li><code>${f v1 ... vN}</code> which is replaced by the string returned by the function <code>f</code> applied to the list <code>[v1; ...; vN]</code>.</li></ul><nav class="toc"><ul><li><a href="#utilities">Utilities</a></li></ul></nav></header><dl><dt class="spec type" id="type-html"><a href="#type-html" class="anchor"></a><code><span class="keyword">type </span>html</code><code><span class="keyword"> = </span>Nethtml.document list</code></dt></dl><dl><dt class="spec value" id="val-compile_html"><a href="#val-compile_html" class="anchor"></a><code><span class="keyword">val </span>compile_html : ?&#8288;trailer_ml:string <span>&#45;&gt;</span> ?&#8288;trailer_mli:string <span>&#45;&gt;</span> ?&#8288;hide:string list <span>&#45;&gt;</span> ?&#8288;module_name:string <span>&#45;&gt;</span> string <span>&#45;&gt;</span> unit</code></dt><dd><p><code>compile_html fname</code> reads the HTML template file <code>fname</code> (typically a file with extension &quot;.html&quot;) and creates an OCaml module with functions to fill the variables of the template. The module will be in files <code>module_name</code>.ml and <code>module_name</code>.mli.</p><dl><dt>parameter module_name</dt><dd><p>the name of the generated module, possibly preceded by a path to indicate where to save the module file. By default, it is the basename of <code>fname</code> without its extension.</p></dd></dl><dl><dt>parameter trailer_ml</dt><dd><p>additional code to be appended to the .ml file. This code can use the functions of the interface (without the module prefix) to set variables of the template. You set a variable <code>v</code> using the value of a variable <code>v'</code>, you should use the construction <code>Set.v tpl (fun t -&gt; ... Get.v' t ...)</code> (which returns a copy of <code>tpl</code> with <code>v</code> set) to ensure that the value of <code>v'</code> at the time of rendering is used and not the one present in <code>tpl</code> when <code>v</code> is set. This is important to maintain the independence of variables which may be set in any order (even if documented, the fact that a variable depends on others will lead to confusion and errors). If you use <code>Get.v</code> inside <code>Set.v</code>, <code>Get.v</code> will return the previous value of the variable <code>v</code>.</p></dd></dl><dl><dt>parameter trailer_mli</dt><dd><p>additional code to be appended to the .mli file.</p></dd></dl><dl><dt>parameter hide</dt><dd><p>variables of the template that will not be present in the module interface. This is only interesting if these variables are used in <code>trailer_ml</code> functions.</p></dd></dl></dd></dl><dl><dt class="spec value" id="val-compile"><a href="#val-compile" class="anchor"></a><code><span class="keyword">val </span>compile : ?&#8288;module_name:string <span>&#45;&gt;</span> string <span>&#45;&gt;</span> unit</code></dt><dd><p><code>compile fname</code> does the same as <code>compile_html</code> except that trailer code is taken from <code>fname</code>.ml and <code>fname</code>.mli for the implementation and interface respectively. Moreover, to hide the signature of a template variable, say &quot;var&quot;, one can add a comment <code>(* \@hide var *)</code> in <code>fname</code>.mli. Special annotations are added to the generated module implementation and interface so errors point back to <code>fname</code>.ml and <code>fname</code>.mli respectively.</p></dd></dl><div class="spec module" id="module-Binding"><a href="#module-Binding" class="anchor"></a><code><span class="keyword">module </span><a href="Binding/index.html">Binding</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></div><dl><dt class="spec value" id="val-subst"><a href="#val-subst" class="anchor"></a><code><span class="keyword">val </span>subst : ?&#8288;base:string <span>&#45;&gt;</span> <a href="Binding/index.html#type-t">Binding.t</a> <span>&#45;&gt;</span> <a href="index.html#type-html">html</a> <span>&#45;&gt;</span> <a href="index.html#type-html">html</a></code></dt><dd><p><code>subst b html</code> return <code>html</code> where all variables are substituted according to the bindings <code>b</code>.</p><dl><dt>parameter base</dt><dd><p>All relative file names in &quot;include&quot; directives are considered to be relative to <code>base</code>. Default: the current working directory.</p></dd></dl><dl><dt>raises Invalid_argument</dt><dd><p>if variable names are not valid or associated values do not correspond to their usage.</p></dd></dl></dd></dl><dl><dt class="spec value" id="val-read"><a href="#val-read" class="anchor"></a><code><span class="keyword">val </span>read : ?&#8288;base:string <span>&#45;&gt;</span> ?&#8288;bindings:<a href="Binding/index.html#type-t">Binding.t</a> <span>&#45;&gt;</span> string <span>&#45;&gt;</span> <a href="index.html#type-html">html</a></code></dt><dd><p><code>read fname</code> reads the file <code>fname</code> and returns its content in a structured form.</p><dl><dt>parameter base</dt><dd><p>All relative file names in &quot;include&quot; directives are considered to be relative to <code>base</code>. Default: the <code>Filename.dirname</code> of <code>fname</code>.</p></dd></dl><dl><dt>parameter bindings</dt><dd><p>if provided, perform the substitutions it mandates. Otherwise, the &quot;raw&quot; HTML is returned (this is the default).</p></dd></dl><dl><dt>raises Sys_error</dt><dd><p>if the file cannot be read.</p></dd></dl></dd></dl><section><header><h2 id="utilities"><a href="#utilities" class="anchor"></a>Utilities</h2></header><dl><dt class="spec value" id="val-write_html"><a href="#val-write_html" class="anchor"></a><code><span class="keyword">val </span>write_html : ?&#8288;doctype:bool <span>&#45;&gt;</span> ?&#8288;perm:int <span>&#45;&gt;</span> <a href="index.html#type-html">html</a> <span>&#45;&gt;</span> string <span>&#45;&gt;</span> unit</code></dt><dd><p><code>write_html html fname</code> writes the textual representation of the <code>html</code> to the file <code>fname</code>.</p><dl><dt>parameter doctype</dt><dd><p>whether to output a doctype (default: <code>true</code>).</p></dd></dl><dl><dt>parameter perm</dt><dd><p>the permissions of the created file (default: <code>0o644</code>). Whatever permissions you specify, the executable bits are removed.</p></dd></dl></dd></dl><dl><dt class="spec value" id="val-body_of"><a href="#val-body_of" class="anchor"></a><code><span class="keyword">val </span>body_of : <a href="index.html#type-html">html</a> <span>&#45;&gt;</span> <a href="index.html#type-html">html</a></code></dt><dd><p><code>body_of html</code> returns the body of the HTML document or the entire document if no body is found.</p></dd></dl><dl><dt class="spec value" id="val-title_of"><a href="#val-title_of" class="anchor"></a><code><span class="keyword">val </span>title_of : <a href="index.html#type-html">html</a> <span>&#45;&gt;</span> string</code></dt><dd><p><code>title_of html</code> returns the title contained in <code>html</code> (if no title is present, it will return <code>&quot;&quot;</code>).</p></dd></dl><div class="spec module" id="module-Path"><a href="#module-Path" class="anchor"></a><code><span class="keyword">module </span><a href="Path/index.html">Path</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></div><dl><dt class="spec value" id="val-iter_html"><a href="#val-iter_html" class="anchor"></a><code><span class="keyword">val </span>iter_html : ?&#8288;langs:string list <span>&#45;&gt;</span> ?&#8288;exts:string list <span>&#45;&gt;</span> ?&#8288;filter:(<a href="Path/index.html#type-t">Path.t</a> <span>&#45;&gt;</span> bool) <span>&#45;&gt;</span> ?&#8288;perm:int <span>&#45;&gt;</span> ?&#8288;out_dir:(string <span>&#45;&gt;</span> string) <span>&#45;&gt;</span> ?&#8288;out_ext:(string <span>&#45;&gt;</span> string) <span>&#45;&gt;</span> string <span>&#45;&gt;</span> (string <span>&#45;&gt;</span> <a href="Path/index.html#type-t">Path.t</a> <span>&#45;&gt;</span> <a href="index.html#type-html">html</a>) <span>&#45;&gt;</span> unit</code></dt><dt class="spec value" id="val-relative_url_are_from_base"><a href="#val-relative_url_are_from_base" class="anchor"></a><code><span class="keyword">val </span>relative_url_are_from_base : <a href="Path/index.html#type-t">Path.t</a> <span>&#45;&gt;</span> <a href="index.html#type-html">html</a> <span>&#45;&gt;</span> <a href="index.html#type-html">html</a></code></dt><dd><p><code>relative_url_are_from_base path html</code> prefix all relative URLs in <code>html</code> so that they are specified according to the directory given by <code>path</code> instead of the base path.</p></dd></dl><dl><dt class="spec value" id="val-email"><a href="#val-email" class="anchor"></a><code><span class="keyword">val </span>email : ?&#8288;args:(string<span class="keyword"> * </span>string) list <span>&#45;&gt;</span> ?&#8288;content:<a href="index.html#type-html">html</a> <span>&#45;&gt;</span> string <span>&#45;&gt;</span> <a href="index.html#type-html">html</a></code></dt><dd><p><code>email e</code> return some HTML/javascript code to protect the email <code>e</code> from SPAM harvesters. The email <code>e</code> may end with &quot;?...&quot; in order to specify options, e.g. <code>?subject=...</code>.</p><dl><dt>parameter args</dt><dd><p>arguments to the &lt;a&gt; HTML tag. Default: <code>[]</code>.</p></dd></dl><dl><dt>parameter content</dt><dd><p>Tells whether the content of the email link is the email itself (no <code>content</code> specified, the default) or some other data.</p></dd></dl></dd></dl><dl><dt class="spec value" id="val-protect_emails"><a href="#val-protect_emails" class="anchor"></a><code><span class="keyword">val </span>protect_emails : <a href="index.html#type-html">html</a> <span>&#45;&gt;</span> <a href="index.html#type-html">html</a></code></dt><dd><p><code>protect_emails html</code> changes all emails hrefs in <code>html</code> in order to make it more difficult for spammers to harvest them.</p></dd></dl><dl><dt class="spec module" id="module-Cache"><a href="#module-Cache" class="anchor"></a><code><span class="keyword">module </span><a href="Cache/index.html">Cache</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></dt><dd><p>Simple cache with dependencies and timeout.</p></dd></dl></section></div></body></html>